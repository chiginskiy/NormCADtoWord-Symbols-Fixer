# NormCADtoWord Symbol Fixer

Макрос для Microsoft Word, исправляющий отображение греческих и математических символов в документах, экспортированных из ПО NormCAD (САПРОТОН).

## Проблема

При экспорте отчётов из NormCAD греческие буквы (γ, ε, φ, μ и др.) и математические символы (≤, ≥, √) отображаются с использованием специальных шрифтов Greek и Math Light. При копировании или редактировании такие символы некорректно отображаются в других программах.

## Решение

Макрос заменяет:
- Латинские символы в шрифте **Greek** → на соответствующие греческие Unicode-символы
- Специальные символы в шрифте **Math Light** → на математические Unicode-символы
- Устанавливает шрифт **Times New Roman** для всех замененных символов

## Возможности

✅ Поиск всех символов с нестандартными шрифтами  
✅ Автоматическая замена на Unicode-символы  
✅ Обработка текста, таблиц, колонтитулов  
✅ Сохранение визуального представления  
✅ Совместимость с любыми приложениями после замены  

## Установка

### Быстрая установка

1. Скачайте файл [`Main.bas`](src/Main.bas)
2. Откройте ваш документ Word
3. Нажмите `Alt + F11` (откроется редактор VBA)
4. В меню выберите `File` → `Import File`
5. Выберите скачанный файл `Main.bas`
6. Закройте редактор VBA

### Ручная установка

1. Откройте документ Word
2. Нажмите `Alt + F11`
3. В меню выберите `Insert` → `Module`
4. Скопируйте код из [`Main.bas`](src/Main.bas) и вставьте в модуль
5. Закройте редактор VBA

## Использование

### 1. Поиск символов с нестандартными шрифтами

```vba
' В редакторе VBA нажмите F5 и выберите:
FindGreekFontCharacters
```

## Структура репозитория

```
NormCADtoWord Symbol Fixer/
│
├── README.md                          # Главное описание (русский + английский)
├── README.en.md                       # Английская версия (опционально)
├── LICENSE                            # Лицензия (MIT или Apache 2.0)
├── CHANGELOG.md                       # История версий
│
├── src/                               # Исходные коды
│   ├── FindGreekFontCharacters.bas    # Модуль поиска символов
│   ├── ReplaceSymbols.bas             # Модуль замены символов
│   └── Main.bas                       # Объединённый модуль (все в одном)
│
├── dist/                              # Готовые файлы для пользователей
│   ├── NormCAD-Symbol-Converter.xlam  # Excel Add-in (если нужен)
│   └── Installation-Guide.pdf         # Инструкция по установке
│
├── docs/                              # Документация
│   ├── installation.md                # Инструкция по установке
│   ├── usage.md                       # Инструкция по использованию
│   ├── screenshots/                   # Скриншоты
│   │   ├── before.jpg                 # До замены
│   │   └── after.jpg                  # После замены
│   └── symbol-mapping.md              # Таблица соответствия символов
│
├── examples/                          # Примеры
│   └── test-document.docx             # Тестовый документ
│
└── .gitattributes                     # Настройки Git для VBA
```

Макрос для Microsoft Word, исправляющий отображение греческих и математических символов в документах, экспортированных из ПО NormCAD (САПРОТОН).

## Проблема

При экспорте отчётов из NormCAD греческие буквы (γ, ε, φ, μ и др.) и математические символы (≤, ≥, √) отображаются с использованием специальных шрифтов Greek и Math Light. При копировании или редактировании такие символы некорректно отображаются в других программах.

## Решение

Макрос заменяет:
- Латинские символы в шрифте **Greek** → на соответствующие греческие Unicode-символы
- Специальные символы в шрифте **Math Light** → на математические Unicode-символы
- Устанавливает шрифт **Times New Roman** для всех замененных символов

## Возможности

✅ Поиск всех символов с нестандартными шрифтами  
✅ Автоматическая замена на Unicode-символы  
✅ Обработка текста, таблиц, колонтитулов  
✅ Сохранение визуального представления  
✅ Совместимость с любыми приложениями после замены  

## Установка

### Быстрая установка

1. Скачайте файл [`ReplaceSymbols.bas`](src/ReplaceSymbols.bas)
2. Откройте ваш документ Word
3. Нажмите `Alt + F11` (откроется редактор VBA)
4. В меню выберите `File` → `Import File`
5. Выберите скачанный файл `ReplaceSymbols.bas`
6. Закройте редактор VBA

## Использование

### 1. Поиск символов с нестандартными шрифтами

```vba
' В редакторе VBA нажмите F5 и выберите:
FindGreekFontCharacters
```

Результат: список всех найденных символов добавится в конец документа.

### 2. Замена символов на Unicode

```vba
' В редакторе VBA нажмите F5 и выберите:
ReplaceGreekFontWithTimesNewRoman
```

Результат: все символы будут заменены на Unicode с шрифтом Times New Roman.

## Таблица соответствия

### Greek → Греческие буквы
```
| Латиница | Unicode | Символ | Название |
|----------|---------|--------|----------|
| a | U+03B1 | α | alpha |
| b | U+03B2 | β | beta |
| g | U+03B3 | γ | gamma |
| e | U+03B5 | ε | epsilon |
| f | U+03C6 | φ | phi |
| m | U+03BC | μ | mu |
| ... | ... | ... | ... |
```
### Math Light → Математические символы
```
| Символ | Unicode | Результат | Название |
|--------|---------|-----------|----------|
| r | U+2264 | ≤ | меньше или равно |
| t | U+2265 | ≥ | больше или равно |
| ; | U+221A | √ | квадратный корень |
```

## Требования

- Microsoft Word 2010 или новее
- Windows
- Включенные макросы


## Автор

Создано для решения проблем с замедлением работы Microsoft Word после вставки отчётов по результатам расчётов из NormCAD.

## Поддержка

При возникновении проблем:
1. Проверьте [Issues](../../issues)
2. Создайте новый Issue с описанием проблемы
3. Приложите скриншот и версию Word

**Ключевые слова:** NormCAD, САПРОТОН, Greek font, Math Light, VBA, Word макрос, Unicode, греческие символы, математические символы

### 4. **CHANGELOG.md**

# Changelog

## [1.0.0] - 2026-01-15

### Added
- Поиск символов с шрифтом Greek
- Замена Greek → греческие Unicode символы
- Поддержка Math Light символов (≤, ≥, √)
- Обработка таблиц и колонтитулов
- Подсчёт замененных символов

